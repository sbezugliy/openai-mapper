#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "openai"

require "open-uri"
require "base64"

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.

question = "generate close to real world distopy, reality and utopy at single image as gradient from left to right of "

dalle = Openai::Images::Create.new
dalle.request(
  prompt: question,
  n: 1,
  size: "1792x1024",
  user: "s.bezugliy@codenv.top",
  response_format: "b64_json",
  model: "dall-e-3"
)

dalle.data.data.each.with_index do |image, index|
  f = File.new(File.join(__dir__, "../output/#{dalle.data.created}-#{index}.png"), "w")
  f.write(Base64.decode64(image.b64_json))
  f.close
end